

LVZtop_depths = [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN       NaN    6.1100    6.0950    8.9050    8.9050       NaN       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN    6.0950    6.0950    8.1250    9.0450    8.1900    7.9850       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN    9.3750    7.7750    8.8900    8.8900    7.0800    6.9400    6.9400       NaN       NaN       NaN;...
       NaN    6.8050    6.9400    9.1700    9.0300    8.8900    9.0300    7.0800    6.9400    7.0650    6.1100       NaN       NaN;...
       NaN    6.9400    7.0650    9.0300    6.3200    8.9600    7.9850    7.9900    6.8750    6.9400    6.1100    6.1100       NaN;...
       NaN    6.8050    6.9400    6.9400    6.1100    7.8500    8.0600    7.9900    8.1250   10.0000    9.0300       NaN       NaN;...
       NaN    9.3050    6.9400    8.8900    6.1100    7.4300    8.0600    8.9600   11.1100   11.1100   10.0000       NaN       NaN;...
       NaN    8.6250    9.1700    8.8900   10.0000   10.0000   10.0000   10.0000    9.0300    8.8900   12.2200   12.6350       NaN;...
       NaN       NaN       NaN       NaN   10.0700   10.0000    9.5150   10.0000    8.1950    7.6350   12.2200   12.2200       NaN;...
       NaN       NaN       NaN       NaN   12.2200   10.0000   10.0000    9.0300    9.0300    8.8900   12.2200       NaN       NaN;...
       NaN       NaN       NaN       NaN       NaN   12.2200       NaN    8.8900    9.1700       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN];

LVZbottom_depths = [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN       NaN   13.9050   15.0150   18.0550   19.0300       NaN       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN   13.7500   14.0300   17.0650   17.0800   18.8900   12.7800       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN   16.9400   17.2200   16.8050   16.1100   13.3300   16.1100   20.0000       NaN       NaN       NaN;...
       NaN   13.3300   13.9050   16.9400   16.1100   16.0400   15.0000   15.4850   17.0800   18.8900   22.2200       NaN       NaN;...
       NaN   13.4700   13.8900   16.0400   15.8350   16.1100   15.0300   16.5250   18.4750   21.3900   21.1100       NaN       NaN;...
       NaN   18.8900   15.0000   15.8350   15.9000   13.9600   15.0300   16.8050   16.9400   22.2200   22.2200       NaN       NaN;...
       NaN   21.1100   20.0000   19.0300   13.0600   14.0450   14.3050   17.0800   17.2200   22.7800   22.2200       NaN       NaN;...
       NaN   19.1700   19.1700   19.0300   15.0000   15.0000   16.1100   16.9400   18.1950   18.1950   21.1100   22.2200       NaN;...
       NaN       NaN   19.0300       NaN   15.0000   16.1100   17.0800   16.1100   17.9200   18.0550   20.1400   20.0000       NaN;...
       NaN       NaN       NaN       NaN   21.1100   18.3300   16.9400   18.0600   18.1950   18.0600   20.0000       NaN       NaN;...
       NaN       NaN       NaN       NaN       NaN       NaN       NaN   18.0600   18.0600       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN];


LVZ_thickness = [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN       NaN    7.7950    8.9200    9.1500   10.1250       NaN       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN    7.6550    7.9350    8.9400    8.0350   10.7000    4.7950       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN    7.5650    9.4450    7.9150    7.2200    6.2500    9.1700   13.0600       NaN       NaN       NaN;...
       NaN    6.5250    6.9650    7.7700    7.0800    7.1500    5.9700    8.4050   10.1400   11.8250   16.1100       NaN       NaN;...
       NaN    6.5300    6.8250    7.0100    9.5150    7.1500    7.0450    8.5350   11.6000   14.4500   15.0000       NaN       NaN;...
       NaN   12.0850    8.0600    8.8950    9.7900    6.1100    6.9700    8.8150    8.8150   12.2200   13.1900       NaN       NaN;...
       NaN   11.8050   13.0600   10.1400    6.9500    6.6150    6.2450    8.1200    6.1100   11.6700   12.2200       NaN       NaN;...
       NaN   10.5450   10.0000   10.1400    5.0000    5.0000    6.1100    6.9400    9.1650    9.3050    8.8900    9.5850       NaN;...
       NaN       NaN       NaN       NaN    4.9300    6.1100    7.5650    6.1100    9.7250   10.4200    7.9200    7.7800       NaN;...
       NaN       NaN       NaN       NaN    8.8900    8.3300    6.9400    9.0300    9.1650    9.1700    7.7800       NaN       NaN;...
       NaN       NaN       NaN       NaN       NaN       NaN       NaN    9.1700    8.8900       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN];


   
   LVZ_relativeamplitude = [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN       NaN    2.7350    2.7595   13.0500   10.9300       NaN       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN    1.3150    2.8850    2.1675    5.5525    6.9650    4.4300       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN    1.6565    2.1900    2.9895    4.3125    3.5150    3.5725    5.4600       NaN       NaN       NaN;...
       NaN    4.2200    4.6550    2.1185    2.3380    3.0800    3.1485    3.1650    3.4870    4.6775    3.6200       NaN       NaN;...
       NaN    4.0600    5.3100    1.7000    1.5300    2.6235    3.3500    3.4000    3.0695    1.8135    3.4380       NaN       NaN;...
       NaN    3.0600    4.3300    4.7080    3.1240    4.1875    4.1415    2.1675    3.1800    1.2280    1.1300       NaN       NaN;...
       NaN    1.2565    2.0750    1.3350    5.9050    3.0000    4.6415    2.3050    2.3350    1.1900    1.0600       NaN       NaN;...
       NaN    1.3840    1.4665    1.1725    4.1100    5.6200    2.4850    1.8500    1.5100    1.9800    1.8250    3.2200       NaN;...
       NaN       NaN       NaN       NaN    3.4400    4.2100    1.6150    1.5000    1.3450    2.0600    1.6000    3.3800       NaN;...
       NaN       NaN       NaN       NaN    1.5900    2.7450    1.7300    2.0600    1.8950    1.2100    2.9400       NaN       NaN;...
       NaN       NaN       NaN       NaN       NaN       NaN       NaN    1.7200    1.9200       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN];
   

LVZ_bottom_multiples = [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN;...
   NaN   NaN   NaN   NaN     2     2     3     3   NaN   NaN   NaN   NaN   NaN;...
   NaN   NaN   NaN     2     2     2     2     3   NaN   NaN   NaN   NaN   NaN;...
   NaN   NaN   NaN     1     2     1     2     1     1     2   NaN   NaN   NaN;...
   NaN     2     2     1     1     1     1     3     1     2     3   NaN   NaN;...
   NaN     3     3     2     2     1     1     1     2     2     2   NaN   NaN;...
   NaN     3     2     3     3     1     1     1     2     2     2   NaN   NaN;...
   NaN     2     2     3     3     2     2     2     2     1     1   NaN   NaN;...
   NaN     2     2     3     2     2     2     2     2     2     4     4   NaN;...
   NaN   NaN     2     3     2     2     1     1     2     2     3     3   NaN;...
   NaN   NaN   NaN   NaN     1     2     1     1     1     1     2   NaN   NaN;...
   NaN   NaN   NaN   NaN   NaN   NaN   NaN     1     1   NaN   NaN   NaN   NaN;...
   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN];


LVZ_relativeamp_fromcode = [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN       NaN    3.7658    2.1742   10.2548   12.0135       NaN       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN    1.3643    4.1779    2.8154    9.5536   12.9830    8.2664       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN    1.3202    2.6284    2.8018    4.1474    3.5418    4.2877    4.7353       NaN       NaN       NaN;...
       NaN    4.0828    3.9529    2.3208    2.5491    3.1213    3.7926    3.6710    3.8522    3.8501    5.0378       NaN       NaN;...
       NaN    5.3380    4.5728    2.5004    1.6240    3.9297    3.2906    4.0623    3.2151    3.0685    3.7272    4.4633       NaN;...
       NaN    3.4733    7.4952    4.6751    3.4426    8.8304    4.9903    2.5973    3.8180    1.8351    2.0364       NaN       NaN;...
       NaN    1.1804    2.6720    2.7632    5.8589    3.8821    5.3196    7.5655    3.0395    1.4558    1.3404       NaN       NaN;...
       NaN    1.1450    1.3928    1.5546    8.2388   12.2348    1.5633    2.6196    1.6652    2.2878    2.1012    2.9409       NaN;...
       NaN       NaN    0.7984       NaN    4.2831    4.6372    1.9668    2.3717    1.7074    2.2033    2.7398    1.2960       NaN;...
       NaN       NaN       NaN       NaN    1.3008    1.3474    2.1419    2.2956    2.4195    1.0211    2.8965       NaN       NaN;...
       NaN       NaN       NaN       NaN       NaN    1.8465       NaN    1.9986    1.6020       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN];


Moho_depths = [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN       NaN   60.1660   49.7925   55.8092   55.8092       NaN       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN   60.0166   58.0913   48.0682   42.0470   54.2185       NaN       NaN       NaN       NaN       NaN;...
       NaN       NaN   54.0802   53.1812   51.0374   48.2711   42.9461   42.1162   53.5602   53.1120       NaN       NaN       NaN;...
       NaN   60.0277   54.0111   52.9046   47.0263   44.7442   39.1425   41.9087   43.7068   52.0055   58.8520       NaN       NaN;...
       NaN   63.0014   56.9157   54.7718   44.8133   43.7068   39.9032   43.0153   42.8770   58.0913   60.8575   59.9585       NaN;...
       NaN   60.9959   61.6875   55.0484   44.9516   43.1535   38.8658   45.5740   47.0263   58.6446   58.0913       NaN       NaN;...
       NaN   59.9585   59.9585   54.7718   56.4316   60.1660   58.0913   57.6763   54.6335   54.7718   56.8465       NaN       NaN;...
       NaN   60.5810   60.0969   56.9848   55.8783       NaN   58.0913   56.9848   56.9848   55.8783   56.9848       NaN       NaN;...
       NaN       NaN       NaN       NaN   68.0498   61.2725   58.9904   56.9848   55.8783   55.8783   55.8783       NaN       NaN;...
       NaN       NaN       NaN       NaN   65.9751   63.9004   60.8575   54.7718   54.7718   54.7718   55.8092       NaN       NaN;...
       NaN       NaN       NaN       NaN       NaN       NaN       NaN   55.8783   56.4316       NaN       NaN       NaN       NaN;...
       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN];

sitestruct = struct('sta', [], 'lat', [], 'lon', [], 'elev', []);
db = dbopen('/raid/data/PLUTONS/antelope/dbmaster/plutons_station', 'r');
db = dblookup_table(db, 'site');
db = dbsubset(db, 'sta=~/PL.*/');
[sitestruct.sta, sitestruct.lat, sitestruct.lon, sitestruct.elev] = dbgetv(db, 'sta', 'lat', 'lon', 'elev');
dbclose(db)
sitestruct.sta(32) = [];
sitestruct.lat(32) = [];
sitestruct.lon(32) = [];
sitestruct.elev(32) = [];
sitestruct.sta(12) = [];
sitestruct.lat(12) = [];
sitestruct.lon(12) = [];
sitestruct.elev(12) = [];
xlim = ([-69 -66.5]);
ylim = ([-22.8 -21.8]);
h = figure();
%ax = axesm('MapProjection', 'mercator', 'MapLatLimit', ylim, 'MapLonLimit', xlim);
% worldmap('Bolivia');

hs = surf(longrid(1,:), latgrid(:,1), -LVZtop_depths);
view([0,90])
colorbar

% hs = surf(longrid(1,:), latgrid(:,1), -LVZbottom_depths);
% view([0,90])
% colorbar

%hs = surf(D.longrid(:,1), D.latgrid(1,:), -LVZ_thickness); 
%hs = surf(D.longrid(:,1), D.latgrid(1,:), -LVZ_relativeamplitude);
%hs = surf(D.longrid(:,1), D.latgrid(1,:), -LVZ_bottom_multiples);
%hs = surf(D.longrid(:,1), D.latgrid(1,:), -LVZ_relativeamp_fromcode);
%hs = surf(D.longrid(:,1), D.latgrid(1,:), -Moho_depths);

shading interp
colormap('hot');
hold on
plot3(sitestruct.lon, sitestruct.lat, sitestruct.elev, '^');
stationlabels = text(sitestruct.lon, sitestruct.lat, [sitestruct.sta], 'VerticalAlignment', 'Top')